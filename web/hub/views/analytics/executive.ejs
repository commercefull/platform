<%- include('../partials/header', { title: pageName }) %>

<div class="content-wrapper">
  <div class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1 class="m-0"><i class="fas fa-briefcase me-2"></i><%= pageName %></h1>
        </div>
        <div class="col-sm-6">
          <ol class="breadcrumb float-sm-end">
            <li class="breadcrumb-item"><a href="/hub/analytics">Analytics</a></li>
            <li class="breadcrumb-item active">Executive</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <section class="content">
    <div class="container-fluid">
      <!-- Key Performance Indicators -->
      <div class="row">
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-info"><i class="fas fa-dollar-sign"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Revenue</span>
              <span class="info-box-number">$<%= (kpis.revenue.current || 0).toLocaleString() %></span>
              <div class="progress">
                <div class="progress-bar bg-info" style="width: <%= Math.min(100, (kpis.revenue.current / kpis.revenue.target * 100) || 0) %>%"></div>
              </div>
              <span class="progress-description">
                <% if (kpis.revenue.growth > 0) { %>
                  <span class="text-success"><i class="fas fa-arrow-up"></i> <%= kpis.revenue.growth.toFixed(1) %>%</span>
                <% } else { %>
                  <span class="text-danger"><i class="fas fa-arrow-down"></i> <%= Math.abs(kpis.revenue.growth).toFixed(1) %>%</span>
                <% } %>
                vs last period
              </span>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-success"><i class="fas fa-chart-pie"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Profit Margin</span>
              <span class="info-box-number"><%= (kpis.profit.margin || 0).toFixed(1) %>%</span>
              <div class="progress">
                <div class="progress-bar bg-success" style="width: <%= Math.min(100, kpis.profit.margin || 0) %>%"></div>
              </div>
              <span class="progress-description">
                Profit: $<%= (kpis.profit.current || 0).toLocaleString() %>
              </span>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-warning"><i class="fas fa-users"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Customers</span>
              <span class="info-box-number"><%= kpis.customers.total || 0 %></span>
              <div class="progress">
                <div class="progress-bar bg-warning" style="width: <%= Math.min(100, (kpis.customers.active / kpis.customers.total * 100) || 0) %>%"></div>
              </div>
              <span class="progress-description">
                Active: <%= kpis.customers.active || 0 %> | 
                <% if (kpis.customers.growth > 0) { %>
                  <span class="text-success"><i class="fas fa-arrow-up"></i> <%= kpis.customers.growth.toFixed(1) %>%</span>
                <% } else { %>
                  <span class="text-danger"><i class="fas fa-arrow-down"></i> <%= Math.abs(kpis.customers.growth).toFixed(1) %>%</span>
                <% } %>
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-primary"><i class="fas fa-shopping-cart"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Orders</span>
              <span class="info-box-number"><%= kpis.orders.total || 0 %></span>
              <span class="progress-description">
                AOV: $<%= (kpis.orders.average || 0).toFixed(2) %> | Conv: <%= ((kpis.orders.conversion || 0) * 100).toFixed(1) %>%
              </span>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-danger"><i class="fas fa-boxes"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Inventory</span>
              <span class="info-box-number">$<%= (kpis.inventory.value || 0).toLocaleString() %></span>
              <span class="progress-description">
                Turnover: <%= (kpis.inventory.turnover || 0).toFixed(2) %> | Stockouts: <%= kpis.inventory.stockouts || 0 %>
              </span>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-6">
          <div class="info-box">
            <span class="info-box-icon bg-secondary"><i class="fas fa-bullhorn"></i></span>
            <div class="info-box-content">
              <span class="info-box-text">Marketing</span>
              <span class="info-box-number">ROI: <%= (kpis.marketing.roi || 0).toFixed(1) %>x</span>
              <span class="progress-description">
                CAC: $<%= (kpis.marketing.cac || 0).toFixed(2) %> | LTV: $<%= (kpis.marketing.ltv || 0).toFixed(2) %>
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Alerts and Trends -->
      <div class="row">
        <div class="col-lg-6">
          <div class="card card-danger">
            <div class="card-header">
              <h3 class="card-title"><i class="fas fa-exclamation-triangle me-2"></i>Business Alerts</h3>
            </div>
            <div class="card-body">
              <% if ((alerts.critical || []).length > 0) { %>
                <% alerts.critical.forEach(function(alert) { %>
                <div class="alert alert-danger" role="alert">
                  <strong><i class="fas fa-times-circle me-2"></i>Critical:</strong> <%= alert.message %>
                  <br><small class="text-muted">Action: <%= alert.action %></small>
                </div>
                <% }); %>
              <% } %>
              <% if ((alerts.warnings || []).length > 0) { %>
                <% alerts.warnings.forEach(function(alert) { %>
                <div class="alert alert-warning" role="alert">
                  <strong><i class="fas fa-exclamation-circle me-2"></i>Warning:</strong> <%= alert.message %>
                  <br><small class="text-muted">Action: <%= alert.action %></small>
                </div>
                <% }); %>
              <% } %>
              <% if ((alerts.opportunities || []).length > 0) { %>
                <% alerts.opportunities.forEach(function(alert) { %>
                <div class="alert alert-info" role="alert">
                  <strong><i class="fas fa-lightbulb me-2"></i>Opportunity:</strong> <%= alert.message %>
                  <br><small class="text-muted">Action: <%= alert.action %></small>
                </div>
                <% }); %>
              <% } %>
              <% if ((alerts.critical || []).length === 0 && (alerts.warnings || []).length === 0 && (alerts.opportunities || []).length === 0) { %>
              <div class="alert alert-success" role="alert">
                <i class="fas fa-check-circle me-2"></i>All systems operating normally. No alerts at this time.
              </div>
              <% } %>
            </div>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="card card-info">
            <div class="card-header">
              <h3 class="card-title"><i class="fas fa-chart-line me-2"></i>Business Trends</h3>
            </div>
            <div class="card-body">
              <% (trends || []).forEach(function(trend) { %>
              <div class="callout callout-<%= trend.impact === 'positive' ? 'success' : trend.impact === 'negative' ? 'danger' : 'warning' %>">
                <h5>
                  <i class="fas fa-arrow-<%= trend.trend %> me-2"></i><%= trend.metric %>
                </h5>
                <p class="mb-0"><%= trend.description %></p>
              </div>
              <% }); %>
              <% if ((trends || []).length === 0) { %>
              <div class="callout callout-info">
                <h5><i class="fas fa-info-circle me-2"></i>No Significant Trends</h5>
                <p class="mb-0">Business metrics are stable with no significant changes detected.</p>
              </div>
              <% } %>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title"><i class="fas fa-bolt me-2"></i>Quick Actions</h3>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <a href="/hub/analytics/reports" class="btn btn-outline-primary btn-block w-100 mb-2">
                    <i class="fas fa-file-alt me-2"></i>Generate Report
                  </a>
                </div>
                <div class="col-md-3">
                  <a href="/hub/analytics/predictive" class="btn btn-outline-success btn-block w-100 mb-2">
                    <i class="fas fa-brain me-2"></i>View Predictions
                  </a>
                </div>
                <div class="col-md-3">
                  <a href="/hub/analytics/customers" class="btn btn-outline-warning btn-block w-100 mb-2">
                    <i class="fas fa-users me-2"></i>Customer Insights
                  </a>
                </div>
                <div class="col-md-3">
                  <a href="/hub/analytics/ai-recommendations" class="btn btn-outline-info btn-block w-100 mb-2">
                    <i class="fas fa-robot me-2"></i>AI Recommendations
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<%- include('../partials/footer') %>
