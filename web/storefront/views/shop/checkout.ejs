<%- include("../partials/header") %>

<main class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Checkout</h1>
      <p class="mt-2 text-sm text-gray-600">Complete your order by filling out the information below</p>
    </div>

    <!-- Flash Messages -->
    <% if (successMsg || errorMsg) { %>
    <div class="mb-8 space-y-3">
      <% if (errorMsg) { %>
      <div class="bg-red-50 border border-red-200 rounded-lg p-4">
        <div class="flex items-center">
          <svg class="w-5 h-5 text-red-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <p class="text-sm text-red-800"><%= errorMsg %></p>
        </div>
      </div>
      <% } %>

      <% if (successMsg) { %>
      <div class="bg-green-50 border border-green-200 rounded-lg p-4">
        <div class="flex items-center">
          <svg class="w-5 h-5 text-green-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <p class="text-sm text-green-800"><%= successMsg %></p>
        </div>
      </div>
      <% } %>
    </div>
    <% } %>

    <% if (basket && basket.items && basket.items.length > 0) { %>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Main Checkout Form -->
      <div class="lg:col-span-2 space-y-8">
        <!-- Billing Information -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              Billing Information
            </h2>
          </div>
          <div class="p-6">
            <form action="/checkout" method="POST" id="checkout-form">
              <!-- Customer Info Display -->
              <% if (customer) { %>
              <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                <div class="flex items-center space-x-3">
                  <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  <div>
                    <p class="text-sm font-medium text-gray-900"><%= customer.firstName %> <%= customer.lastName %></p>
                    <p class="text-sm text-gray-600"><%= customer.email %></p>
                  </div>
                </div>
              </div>
              <% } %>

              <!-- Billing Address -->
              <div class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label for="billingFirstName" class="block text-sm font-medium text-gray-700 mb-2">
                      First Name
                    </label>
                    <input
                      type="text"
                      id="billingFirstName"
                      name="billingFirstName"
                      value="<%= customer ? customer.firstName : '' %>"
                      required
                      class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                      placeholder="Enter your first name"
                    >
                  </div>

                  <div>
                    <label for="billingLastName" class="block text-sm font-medium text-gray-700 mb-2">
                      Last Name
                    </label>
                    <input
                      type="text"
                      id="billingLastName"
                      name="billingLastName"
                      value="<%= customer ? customer.lastName : '' %>"
                      required
                      class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                      placeholder="Enter your last name"
                    >
                  </div>
                </div>

                <div>
                  <label for="billingEmail" class="block text-sm font-medium text-gray-700 mb-2">
                    Email Address
                  </label>
                  <input
                    type="email"
                    id="billingEmail"
                    name="billingEmail"
                    value="<%= customer ? customer.email : '' %>"
                    required
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                    placeholder="Enter your email"
                  >
                </div>

                <div>
                  <label for="billingAddress" class="block text-sm font-medium text-gray-700 mb-2">
                    Street Address
                  </label>
                  <input
                    type="text"
                    id="billingAddress"
                    name="billingAddress"
                    required
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                    placeholder="Enter your street address"
                  >
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div>
                    <label for="billingCity" class="block text-sm font-medium text-gray-700 mb-2">
                      City
                    </label>
                    <input
                      type="text"
                      id="billingCity"
                      name="billingCity"
                      required
                      class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                      placeholder="City"
                    >
                  </div>

                  <div>
                    <label for="billingState" class="block text-sm font-medium text-gray-700 mb-2">
                      State
                    </label>
                    <input
                      type="text"
                      id="billingState"
                      name="billingState"
                      required
                      class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                      placeholder="State"
                    >
                  </div>

                  <div>
                    <label for="billingZip" class="block text-sm font-medium text-gray-700 mb-2">
                      ZIP Code
                    </label>
                    <input
                      type="text"
                      id="billingZip"
                      name="billingZip"
                      required
                      class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent sm:text-sm"
                      placeholder="ZIP"
                    >
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Shipping Information -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-green-600 to-teal-600 px-6 py-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
              </svg>
              Shipping Information
            </h2>
          </div>
          <div class="p-6">
            <div class="mb-6">
              <label class="flex items-center">
                <input
                  type="checkbox"
                  id="sameAddress"
                  checked
                  class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"
                >
                <span class="ml-3 text-sm text-gray-700">Shipping address is the same as billing address</span>
              </label>
            </div>

            <div id="shippingAddress" class="hidden space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label for="shippingFirstName" class="block text-sm font-medium text-gray-700 mb-2">
                    First Name
                  </label>
                  <input
                    type="text"
                    id="shippingFirstName"
                    name="shippingFirstName"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                    placeholder="First name"
                  >
                </div>

                <div>
                  <label for="shippingLastName" class="block text-sm font-medium text-gray-700 mb-2">
                    Last Name
                  </label>
                  <input
                    type="text"
                    id="shippingLastName"
                    name="shippingLastName"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                    placeholder="Last name"
                  >
                </div>
              </div>

              <div>
                <label for="shippingAddressInput" class="block text-sm font-medium text-gray-700 mb-2">
                  Street Address
                </label>
                <input
                  type="text"
                  id="shippingAddressInput"
                  name="shippingAddress"
                  class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                  placeholder="Enter shipping address"
                >
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label for="shippingCity" class="block text-sm font-medium text-gray-700 mb-2">
                    City
                  </label>
                  <input
                    type="text"
                    id="shippingCity"
                    name="shippingCity"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                    placeholder="City"
                  >
                </div>

                <div>
                  <label for="shippingState" class="block text-sm font-medium text-gray-700 mb-2">
                    State
                  </label>
                  <input
                    type="text"
                    id="shippingState"
                    name="shippingState"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                    placeholder="State"
                  >
                </div>

                <div>
                  <label for="shippingZip" class="block text-sm font-medium text-gray-700 mb-2">
                    ZIP Code
                  </label>
                  <input
                    type="text"
                    id="shippingZip"
                    name="shippingZip"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent sm:text-sm"
                    placeholder="ZIP"
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Shipping Method -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-orange-600 to-red-600 px-6 py-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
              </svg>
              Shipping Method
            </h2>
          </div>
          <div class="p-6">
            <div class="space-y-4">
              <% shippingMethods.forEach(method => { %>
              <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                <input
                  id="shipping-<%= method.shippingMethodId %>"
                  name="shippingMethodId"
                  type="radio"
                  value="<%= method.shippingMethodId %>"
                  class="h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300"
                  <%= shippingMethods.indexOf(method) === 0 ? 'checked' : '' %>
                  required
                >
                <div class="ml-4 flex-1">
                  <div class="flex items-center justify-between">
                    <span class="text-sm font-medium text-gray-900"><%= method.name %></span>
                    <span class="text-sm font-semibold text-gray-900">$<%= parseFloat(method.cost).toFixed(2) %></span>
                  </div>
                </div>
              </label>
              <% }) %>
            </div>
          </div>
        </div>

        <!-- Payment Method -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
              </svg>
              Payment Method
            </h2>
          </div>
          <div class="p-6">
            <!-- Payment Method Selection -->
            <div class="mb-6 space-y-4">
              <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                <input
                  id="credit"
                  name="paymentMethod"
                  type="radio"
                  value="credit_card"
                  checked
                  required
                  class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"
                >
                <div class="ml-4 flex items-center">
                  <svg class="w-8 h-8 text-gray-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                  </svg>
                  <span class="text-sm font-medium text-gray-900">Credit Card</span>
                </div>
              </label>

              <label class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                <input
                  id="paypal"
                  name="paymentMethod"
                  type="radio"
                  value="paypal"
                  required
                  class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"
                >
                <div class="ml-4 flex items-center">
                  <svg class="w-8 h-8 text-blue-600 mr-3" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.622 1.403 1.43.984 2.099 2.602 1.889 4.439-.217 1.79-.927 3.278-1.974 4.515-.903 1.055-2.245 1.907-3.606 1.907h-1.056c-.328 0-.585.215-.585.5v.5c0 .285.257.5.585.5h.962c1.093 0 2.053-.547 2.711-1.384.948-.95 1.593-2.396 1.806-4.146.161-1.321-.069-2.424-.841-3.166-.701-.678-1.893-1.176-3.404-1.176h-6.192c-.468 0-.858.26-.858.657v.823c0 .397.39.657.858.657h4.437c.687 0 1.257.18 1.666.54.411.356.671.881.671 1.482 0 .819-.429 1.512-1.063 1.904-.639.394-1.457.59-2.333.59h-1.866c-.655 0-1.118.215-1.118.5v.5c0 .285.463.5 1.118.5h.962c.917 0 1.769-.215 2.46-.59.691-.375 1.209-.944 1.563-1.649.354-.709.563-1.536.563-2.439 0-1.733-.725-3.1-2.112-3.854C12.148.825 10.438.5 8.687.5H6.211c-.328 0-.585.215-.585.5v.5c0 .285.257.5.585.5h1.866c.917 0 1.769.215 2.46.59.691.375 1.209.944 1.563 1.649.354.709.563 1.536.563 2.439 0 1.733-.725 3.1-2.112 3.854C9.271 21.087 7.561 21.412 5.81 21.412h-1.056c-.328 0-.585-.215-.585-.5v-.5c0-.285.257-.5.585-.5h.962c.328 0 .585-.215.585-.5v-.5c0-.285-.257-.5-.585-.5z"/>
                  </svg>
                  <span class="text-sm font-medium text-gray-900">PayPal</span>
                </div>
              </label>
            </div>

            <!-- Credit Card Form -->
            <div id="credit-card-form" class="space-y-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label for="cc-name" class="block text-sm font-medium text-gray-700 mb-2">
                    Name on Card
                  </label>
                  <input
                    type="text"
                    id="cc-name"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent sm:text-sm"
                    placeholder="John Doe"
                    required
                  >
                </div>

                <div>
                  <label for="cc-number" class="block text-sm font-medium text-gray-700 mb-2">
                    Card Number
                  </label>
                  <input
                    type="text"
                    id="cc-number"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent sm:text-sm"
                    placeholder="1234 5678 9012 3456"
                    required
                  >
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label for="cc-expiration" class="block text-sm font-medium text-gray-700 mb-2">
                    Expiration Date
                  </label>
                  <input
                    type="text"
                    id="cc-expiration"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent sm:text-sm"
                    placeholder="MM/YY"
                    required
                  >
                </div>

                <div>
                  <label for="cc-cvv" class="block text-sm font-medium text-gray-700 mb-2">
                    CVV
                  </label>
                  <input
                    type="text"
                    id="cc-cvv"
                    class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent sm:text-sm"
                    placeholder="123"
                    required
                  >
                </div>
              </div>
            </div>

            <!-- PayPal Form -->
            <div id="paypal-form" class="hidden">
              <div class="text-center py-8">
                <svg class="w-16 h-16 text-blue-600 mx-auto mb-4" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.622 1.403 1.43.984 2.099 2.602 1.889 4.439-.217 1.79-.927 3.278-1.974 4.515-.903 1.055-2.245 1.907-3.606 1.907h-1.056c-.328 0-.585.215-.585.5v.5c0 .285.257.5.585.5h.962c1.093 0 2.053-.547 2.711-1.384.948-.95 1.593-2.396 1.806-4.146.161-1.321-.069-2.424-.841-3.166-.701-.678-1.893-1.176-3.404-1.176h-6.192c-.468 0-.858.26-.858.657v.823c0 .397.39.657.858.657h4.437c.687 0 1.257.18 1.666.54.411.356.671.881.671 1.482 0 .819-.429 1.512-1.063 1.904-.639.394-1.457.59-2.333.59h-1.866c-.655 0-1.118.215-1.118.5v.5c0 .285.463.5 1.118.5h.962c.917 0 1.769-.215 2.46-.59.691-.375 1.209-.944 1.563-1.649.354-.709.563-1.536.563-2.439 0-1.733-.725-3.1-2.112-3.854C12.148.825 10.438.5 8.687.5H6.211c-.328 0-.585.215-.585.5v.5c0 .285.257.5.585.5h1.866c.917 0 1.769.215 2.46.59.691.375 1.209.944 1.563 1.649.354.709.563 1.536.563 2.439 0 1.733-.725 3.1-2.112 3.854C9.271 21.087 7.561 21.412 5.81 21.412h-1.056c-.328 0-.585-.215-.585-.5v-.5c0-.285.257-.5.585-.5h.962c.328 0 .585-.215.585-.5v-.5c0-.285-.257-.5-.585-.5z"/>
                </svg>
                <p class="text-gray-600">You will be redirected to PayPal to complete your payment securely.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Special Instructions -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-gray-600 to-gray-700 px-6 py-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
              </svg>
              Special Instructions
            </h2>
          </div>
          <div class="p-6">
            <label for="specialInstructions" class="block text-sm font-medium text-gray-700 mb-2">
              Delivery Instructions (Optional)
            </label>
            <textarea
              id="specialInstructions"
              name="specialInstructions"
              rows="4"
              class="appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent sm:text-sm"
              placeholder="Any special delivery instructions, gate codes, or preferences..."
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Order Summary Sidebar -->
      <div class="space-y-6">
        <!-- Cart Summary -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="bg-gradient-to-r from-emerald-600 to-green-600 px-6 py-4">
            <h3 class="text-lg font-semibold text-white flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H19M7 13v8a2 2 0 002 2h10a2 2 0 002-2v-3"></path>
              </svg>
              Order Summary
            </h3>
          </div>
          <div class="p-6">
            <!-- Cart Items -->
            <div class="space-y-4 mb-6">
              <% basket.items.forEach(item => { %>
              <div class="flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0">
                <div class="flex-1 min-w-0">
                  <h4 class="text-sm font-medium text-gray-900 truncate"><%= item.name %></h4>
                  <p class="text-sm text-gray-600">Qty: <%= item.quantity %></p>
                </div>
                <div class="text-sm font-semibold text-gray-900">
                  $<%= (parseFloat(item.price) * item.quantity).toFixed(2) %>
                </div>
              </div>
              <% }) %>
            </div>

            <!-- Order Totals -->
            <div class="space-y-3 border-t border-gray-200 pt-4">
              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">Subtotal</span>
                <span class="text-sm text-gray-900">$<%= totals.subtotal %></span>
              </div>

              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">Tax</span>
                <span class="text-sm text-gray-900">$<%= totals.tax %></span>
              </div>

              <div class="flex justify-between items-center">
                <span class="text-sm text-gray-600">Shipping</span>
                <span class="text-sm text-gray-900">$<%= totals.shipping %></span>
              </div>

              <hr class="border-gray-200">

              <div class="flex justify-between items-center">
                <span class="text-lg font-semibold text-gray-900">Total</span>
                <span class="text-lg font-bold text-green-600">$<%= totals.total %></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Checkout Button -->
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
          <div class="p-6">
            <button
              type="submit"
              form="checkout-form"
              class="w-full flex justify-center items-center px-6 py-4 border border-transparent text-lg font-semibold rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"
            >
              <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Complete Order - $<%= totals.total %>
            </button>
            <p class="text-xs text-gray-500 text-center mt-3">
              Your payment information is secure and encrypted
            </p>
          </div>
        </div>
      </div>
    </div>
    <% } else { %>
    <!-- Empty Cart -->
    <div class="bg-white shadow-lg rounded-xl overflow-hidden">
      <div class="px-6 py-12 text-center">
        <div class="mx-auto h-24 w-24 bg-gray-100 rounded-full flex items-center justify-center mb-6">
          <svg class="h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H19M7 13v8a2 2 0 002 2h10a2 2 0 002-2v-3"></path>
          </svg>
        </div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">Your cart is empty</h3>
        <p class="text-gray-600 mb-6">Add some items to your cart before proceeding to checkout.</p>
        <a
          href="/products"
          class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition-colors"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
          </svg>
          Continue Shopping
        </a>
      </div>
    </div>
    <% } %>
  </div>
</main>

<script type="text/javascript" src="/storefront/javascripts/checkout.js"></script>

<%- include("../partials/footer") %>
