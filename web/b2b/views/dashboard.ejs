<!-- Stats Row -->
<div class="row">
  <div class="col-lg-3 col-6">
    <div class="small-box bg-info">
      <div class="inner">
        <h3><%= stats?.totalOrders || 0 %></h3>
        <p>Total Orders</p>
      </div>
      <div class="icon">
        <i class="fas fa-shopping-cart"></i>
      </div>
      <a href="/b2b/orders" class="small-box-footer">View orders <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="small-box bg-success">
      <div class="inner">
        <h3>$<%= (stats?.totalSpent || 0).toFixed(0) %></h3>
        <p>Total Spent</p>
      </div>
      <div class="icon">
        <i class="fas fa-dollar-sign"></i>
      </div>
      <a href="/b2b/orders" class="small-box-footer">View history <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="small-box bg-warning">
      <div class="inner">
        <h3><%= stats?.pendingApprovals || 0 %></h3>
        <p>Pending Approvals</p>
      </div>
      <div class="icon">
        <i class="fas fa-clock"></i>
      </div>
      <a href="/b2b/approvals" class="small-box-footer">View approvals <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <div class="col-lg-3 col-6">
    <div class="small-box bg-primary">
      <div class="inner">
        <h3><%= stats?.activeQuotes || 0 %></h3>
        <p>Active Quotes</p>
      </div>
      <div class="icon">
        <i class="fas fa-file-invoice"></i>
      </div>
      <a href="/b2b/quotes" class="small-box-footer">View quotes <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
</div>

<div class="row">
  <!-- Recent Orders -->
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Recent Orders</h3>
        <div class="card-tools">
          <a href="/b2b/orders" class="btn btn-tool btn-sm"><i class="fas fa-arrow-right"></i></a>
        </div>
      </div>
      <div class="card-body p-0">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Order #</th>
              <th>Amount</th>
              <th>Status</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <% if (recentOrders && recentOrders.length > 0) { %>
              <% recentOrders.forEach(order => { %>
                <tr>
                  <td><a href="/b2b/orders/<%= order.orderId %>"><%= order.orderNumber %></a></td>
                  <td>$<%= (order.totalAmount || 0).toFixed(2) %></td>
                  <td><span class="badge badge-secondary"><%= order.status %></span></td>
                  <td><%= new Date(order.createdAt).toLocaleDateString() %></td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr><td colspan="4" class="text-center text-muted">No orders yet</td></tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Pending Approvals -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Pending Approvals</h3>
        <div class="card-tools">
          <% if (typeof user !== 'undefined' && user && (user.role === 'approver' || user.role === 'admin')) { %>
            <a href="/b2b/approvals" class="btn btn-tool btn-sm"><i class="fas fa-arrow-right"></i></a>
          <% } %>
        </div>
      </div>
      <div class="card-body p-0">
        <ul class="products-list product-list-in-card pl-2 pr-2">
          <% if (pendingApprovals && pendingApprovals.length > 0) { %>
            <% pendingApprovals.forEach(approval => { %>
              <li class="item">
                <div class="product-info">
                  <span class="product-title">
                    <%= approval.requestedByName %>
                    <a href="/b2b/approvals/<%= approval.approvalRequestId %>" class="btn btn-xs btn-primary float-right">Review</a>
                  </span>
                  <span class="product-description">
                    <%= approval.type || 'Purchase Request' %>
                  </span>
                </div>
              </li>
            <% }) %>
          <% } else { %>
            <li class="item text-center text-muted py-3">No pending approvals</li>
          <% } %>
        </ul>
      </div>
    </div>
  </div>
</div>
