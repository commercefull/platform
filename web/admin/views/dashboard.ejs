<!-- Page Header -->
<div class="page-header d-print-none">
  <div class="row g-2 align-items-center">
    <div class="col">
      <h2 class="page-title">
        <%= pageName %>
      </h2>
    </div>
  </div>
</div>

<!-- Primary Stats Row -->
<div class="row row-deck row-cards">
  <div class="col-sm-6 col-lg-3">
    <div class="card">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="subheader">Total Orders</div>
          <div class="ms-auto lh-1">
            <div class="text-muted small">This month</div>
          </div>
        </div>
        <div class="h1 mb-3"><%= stats.totalOrders %></div>
        <div class="d-flex">
          <a href="/admin/orders" class="btn btn-primary btn-sm">View Orders</a>
        </div>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="subheader">Total Revenue</div>
          <div class="ms-auto lh-1">
            <div class="text-muted small">This month</div>
          </div>
        </div>
        <div class="h1 mb-3">$<%= (stats.totalRevenue || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) %></div>
        <div class="d-flex">
          <a href="/admin/analytics" class="btn btn-success btn-sm">View Analytics</a>
        </div>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="subheader">Total Customers</div>
          <div class="ms-auto lh-1">
            <div class="text-muted small">Registered</div>
          </div>
        </div>
        <div class="h1 mb-3"><%= stats.totalCustomers %></div>
        <div class="d-flex">
          <a href="/admin/customers" class="btn btn-warning btn-sm">View Customers</a>
        </div>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-lg-3">
    <div class="card">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="subheader">Total Products</div>
          <div class="ms-auto lh-1">
            <div class="text-muted small">Active</div>
          </div>
        </div>
        <div class="h1 mb-3"><%= stats.totalProducts %></div>
        <div class="d-flex">
          <a href="/admin/products" class="btn btn-danger btn-sm">View Products</a>
        </div>
      </div>
    </div>
  </div>
</div>

    <!-- Secondary Stats Row -->
    <div class="row row-deck row-cards mt-3">
      <div class="col-sm-6 col-lg-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-primary text-white avatar">
                  <svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
                    <path d="M12 7v5l3 3"></path>
                  </svg>
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium"><%= stats.pendingOrders %></div>
                <div class="text-muted">Pending Orders</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-warning text-white avatar">
                  <svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M12 9v2m0 4v.01"></path>
                    <path d="M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75"></path>
                  </svg>
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium"><%= stats.lowStockProducts %></div>
                <div class="text-muted">Low Stock Items</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-info text-white avatar">
                  <svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                    <path d="M17 19m-2 0a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                    <path d="M17 17h-11v-14h-2"></path>
                    <path d="M6 5l14 1l-1 7h-13"></path>
                  </svg>
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium"><%= stats.todayOrders %></div>
                <div class="text-muted">Today's Orders</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-success text-white avatar">
                  <svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M9 5h-2a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10a2 2 0 0 0 -2 -2h-2"></path>
                    <path d="M9 5a2 2 0 0 2 2v2a2 2 0 0 1 -2 2a2 2 0 0 0 -2 -2v-2a2 2 0 0 2 -2"></path>
                    <path d="M9 12l2 2l4 -4"></path>
                  </svg>
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium">$<%= (stats.todayRevenue || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) %></div>
                <div class="text-muted">Today's Revenue</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts and Tables Row -->
    <div class="row row-deck row-cards mt-3">
      <!-- Revenue Overview and Top Products -->
      <div class="col-lg-8">
        <!-- Revenue Chart -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Revenue Overview</h3>
          </div>
          <div class="card-body">
            <canvas id="revenueChart" height="200"></canvas>
          </div>
        </div>
      </div>

      <!-- Top Products Section -->
      <div class="col-lg-4">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Top Products</h3>
          </div>
          <div class="card-body">
            <% (topProducts || []).forEach(function(product) { %>
            <div class="d-flex align-items-center mb-3">
              <div class="me-3">
                <span class="bg-secondary text-white avatar">
                  <svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M12 3l8 4.5v9l-8 4.5l-8 -4.5v-9l8 -4.5"></path>
                    <path d="M12 12l8 -4.5"></path>
                    <path d="M12 12v9"></path>
                    <path d="M12 12l-8 -4.5"></path>
                  </svg>
                </span>
              </div>
              <div class="flex-fill">
                <div class="font-weight-medium">
                  <a href="/admin/products/<%= product.productId %>"><%= product.name %></a>
                </div>
                <div class="text-muted"><%= product.totalSold %> sold â€¢ $<%= (product.revenue || 0).toFixed(2) %></div>
              </div>
            </div>
            <% }); %>
            <% if ((topProducts || []).length === 0) { %>
            <div class="text-center text-muted">No product sales yet</div>
            <% } %>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Orders Row -->
    <div class="row row-deck row-cards mt-3">
      <div class="col-12">
        <!-- Recent Orders -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Recent Orders</h3>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-vcenter">
                <thead>
                  <tr>
                    <th>Order #</th>
                    <th>Customer</th>
                    <th>Status</th>
                    <th>Amount</th>
                    <th>Date</th>
                  </tr>
                </thead>
                <tbody>
                  <% (recentOrders || []).forEach(function(order) { %>
                  <tr>
                    <td><a href="/admin/orders/<%= order.orderId %>">#<%= order.orderNumber %></a></td>
                    <td><%= order.customerName %></td>
                    <td>
                      <span class="badge bg-<%= order.status === 'completed' ? 'success' : order.status === 'pending' ? 'warning' : order.status === 'cancelled' ? 'danger' : 'info' %>">
                        <%= order.status %>
                      </span>
                    </td>
                    <td>$<%= (order.totalAmount || 0).toFixed(2) %></td>
                    <td><%= new Date(order.createdAt).toLocaleDateString() %></td>
                  </tr>
                  <% }); %>
                  <% if ((recentOrders || []).length === 0) { %>
                  <tr>
                    <td colspan="5" class="text-center text-muted">No orders yet</td>
                  </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
          </div>
          <div class="card-footer">
            <a href="/admin/orders" class="btn btn-primary">View All Orders</a>
          </div>
        </div>
      </div>
    </div>

<!-- Chart.js and Dashboard Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/javascripts/admin/dashboard.js"></script>
